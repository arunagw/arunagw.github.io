
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Arun Agrawal&#8217;s Blog</title>
  <meta name="author" content="Arun Agrawal">

  
  <meta name="description" content="ruby on rails contributor and developer">
  <meta name="keywords" content="arunagw, Arun Agrawal, ruby, rubyonrails, rails, design, developer, rails contributor">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://arun.im/2">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://feeds.feedburner.com/ArunAgrawal" rel="alternate" title="Arun Agrawal's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-8185166-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Arun Agrawal&#8217;s Blog</a></h1>
  
    <h2>Ruby on Rails Developer</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/ArunAgrawal" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:arun.im" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/contact">Contact</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/respond-custom-formats-rails/">Respond to Custom Formats in Rails</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-24T00:00:00+02:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content">We usually respond some of the known formats in Rails Application like HTML, XML, JavaScript, RSS and some custom.

Have you tried to use your own custom format for your Rails Application?

Yes you can use your custom format in Rails Application.

Here showing a simple Rails Application with responding custom formats.

Get a new app
<pre>rails new music_library </pre>

Get a scaffold into App

<pre>rails generate scaffold mp3 title:string url:string description:text </pre>

Ok so you are ready to serve some music on your app with some formats!

Now you have to register MIME types in the Rails Application.

For that open up <code>Rails.root/config/initializers/mime_types.rb</code>

<pre>
Mime::Type.register 'audio/mpeg' , :mp3
</pre>

<strong>Now you can serve <code>.mp3</code> and content</strong>

For that your respond block should look like
<pre>
def show
  @mp3 = Mp3.find(params[:id])
  respond_to do |format|
    format.mp3 { redirect_to @mp3.url }
  end
end
</pre>

Now if you call this action with <code>.mp3</code>
<pre>http://localhost:3000/mp3s/1.mp3</pre>

You will redirect_to <code>@mp3</code> url.
    
    Happy adding custom formats!!
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/x-request-id-tracking-taggedlogging-rails/">X-Request-Id Tracking and TaggedLogging in Rails3.2</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-21T00:00:00+02:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><strong>Rails 3.2 will come with X-Request-Id tracking and TaggedLogging support!! Recently <a href="http://twitter.com/dhh">DHH</a> added this feature <a href="https://github.com/rails/rails/commit/afde6fdd5ef3e6b0693a7e330777e85ef4cffddb">here</a>!</strong>

This makes it easy to trace requests from end-to-end in the stack and to identify individual requests in mixed logs.

If you have application on SAS model. Where you have logs filled with mixed request for all your customers. May be you need to filter out requests start with some specific subdomain. TaggedLogging will help you in that.

Where as the X-Request-Id feature will help you to track log with the same request. So in mixed logs you can easily find out the unique id logs for a request.

It will tag the log with the unique id for that request in the log. So later you can easily trace them down.

May be later on you can add more tags for your logs. If those methods are supported by the request object!

I am showing here some logs here with X-Request-Id
<pre>[2011-10-21 19:57:55] INFO  WEBrick 1.3.1
[2011-10-21 19:57:55] INFO  ruby 2.0.0 (2011-10-19) [x86_64-darwin11.2.0]
[2011-10-21 19:57:55] INFO  WEBrick::HTTPServer#start: pid=1585 port=3000
<strong><em>[9fda80066583f52e695a089d8622439c]</em> </strong>

Started GET "/blogs" for 127.0.0.1 at 2011-10-21 19:57:59 +0530
<strong><em>[9fda80066583f52e695a089d8622439c]</em> </strong> Processing by BlogsController#index as HTML
<strong><em>[9fda80066583f52e695a089d8622439c]</em> </strong>   Blog Load (0.2ms)  SELECT "blogs".* FROM "blogs"
<strong><em>[9fda80066583f52e695a089d8622439c]</em> </strong>   Rendered blogs/index.html.erb within layouts/application (8.8ms)
<strong><em>[9fda80066583f52e695a089d8622439c]</em> </strong> Completed 200 OK in 32ms (Views: 30.4ms | ActiveRecord: 0.3ms)
[2011-10-21 19:57:59] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true
[0962521e4215d645367b58fa41da9f0d] 

Started GET "/assets/application.css?body=1" for 127.0.0.1 at 2011-10-21 19:57:59 +0530
[0962521e4215d645367b58fa41da9f0d] Served asset /application.css - 304 Not Modified (0ms)
[2011-10-21 19:57:59] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true
[a7204cec4d2b2e930ac05b41fa1a5c65] 

Started GET "/assets/jquery_ujs.js?body=1" for 127.0.0.1 at 2011-10-21 19:57:59 +0530
[a7204cec4d2b2e930ac05b41fa1a5c65] Served asset /jquery_ujs.js - 304 Not Modified (1ms)
[2011-10-21 19:57:59] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true
[202eadd97820dfbf429f87f4725324c3] 

Started GET "/assets/blogs.css?body=1" for 127.0.0.1 at 2011-10-21 19:57:59 +0530
[202eadd97820dfbf429f87f4725324c3] Served asset /blogs.css - 304 Not Modified (2ms)
[2011-10-21 19:57:59] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true
[769a2752906bb0c2c5d1eae0a76ac328]</pre>
Here I showed some logs in strong. They are the same request for the index page tagged with the same unique id.
The same concept for the subdomain. The subdomain will also come as a tag.

<strong>You can also log some of the custom events in log file with the tags!</strong>
<pre>Logger.tagged("BCX") { Logger.info "Stuff" }                            # Logs "[BCX] Stuff"
Logger.tagged("BCX", "Jason") { Logger.info "Stuff" }                   # Logs "[BCX] [Jason] Stuff"
Logger.tagged("BCX") { Logger.tagged("Jason") { Logger.info "Stuff" } } # Logs "[BCX] [Jason] Stuff"</pre>
How to configure it ??

Open up your <code>production.rb </code> or your custom environment file, uncomment the line for <code>log_tags</code>
<pre>config.log_tags = [ :subdomain, :uuid ]</pre>
And you will get tagged logs with useful information.

Useful links :

Commit URL : <a href="https://github.com/rails/rails/commit/afde6fdd5ef3e6b0693a7e330777e85ef4cffddb">https://github.com/rails/rails/commit/afde6fdd5ef3e6b0693a7e330777e85ef4cffddb</a>
Feature Branch : 3.2

Cheers,
<a href="http://twitter.com/arunagw">@arunagw</a>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/rails-3-1-jruby/">Rails 3.1 and JRuby</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-10T00:00:00+02:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content">Hi Folks,

If you are doing any application in which you required JRuby as a platform. You can use Rails3.1 with that. activerecord-jdbc-adapter 1.2.0 is ok with that!

All the steps are same as for the normal Rails Application

You can find more details here <a href="http://blog.jruby.org/2011/09/ar-jdbc-1-2-0-released/">http://blog.jruby.org/2011/09/ar-jdbc-1-2-0-released/</a>

&nbsp;

Cheers,
Arun
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/submit-patch-rails-github-fork-edit-button/">Submit a Patch for Rails on Github Using &#8220;Fork and Edit Button&#8221;</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-11T00:00:00+02:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content">Hi Folks,

I have recently written about my Rails Contributions experience <a title="Arun Agrawal Rails" href="http://agrawalarun.com/2011/08/03/working-as-a-rails-contributor/" target="_blank">here</a>.

I see that now days contribution is Rails is increased. People love to contribute in Open Source projects. And the way should be easy not painful.

I found that some people are struggling in submitting Pull Requests in Rails on Github. So i thought of writing the same to help them.

Some people are new to git and they don&#8217;t know much about git&#8230; or sometime patch is very small and they want to use Github&#8217;s &#8220;fork and edit this file&#8221; feature to submit a patch.

And some people who are good in Rails will do it in more easy manner. And easy to open multiple pull request at a time from the same branch.

I am writing some steps to use Github&#8217;s fork and edit feature to open pull request.
<p style="text-align: center;"><strong>Open up your project on Github open up file where you want to change</strong></p>
<p style="text-align: center;"><a href="/assets/images/fork_and_edit.jpg"><img class="aligncenter size-full wp-image-239" title="fork_and_edit" src="/assets/images/fork_and_edit.jpg" alt="" width="975" height="270" /></a></p>
<p style="text-align: center;"><strong>Change your desired things into the file. You can only change one file in one commit</strong></p>
<p style="text-align: center;"><a href="/assets/images/make_changes.jpg"><img class="aligncenter size-full wp-image-240" title="make_changes" src="/assets/images/make_changes.jpg" alt="" width="972" height="781" /></a></p>
<p style="text-align: center;"><strong>Propese your file changes! Here you can write about your changes. Give some references about issue. Can see the file changed. Can see the commits which you have made.</strong></p>
<p style="text-align: center;"><a href="/assets/images/pr_discussion.jpg"><img class="aligncenter size-full wp-image-243" title="pr_discussion" src="/assets/images/pr_discussion.jpg" alt="" width="953" height="533" /></a></p>
<p style="text-align: center;"><strong>Change commit is the most important part. The reason is when people are doing changes in specific branch. Let&#8217;s take a example of Rails. If you are going to submit a patch against Rails 3.0.X version then you must have to choose 3-0-stable branch instead of master in Base branch.</strong></p>
<p style="text-align: center;"><strong>After updating the commit range you can submit the Pull Request and also must see the File Changed.</strong></p>
<p style="text-align: left;"><a href="/assets/images/pr_change_commits.jpg"><img class="aligncenter size-full wp-image-241" title="pr_change_commits" src="/assets/images/pr_change_commits.jpg" alt="" width="956" height="397" /></a><strong></strong></p>
<p style="text-align: left;"><em><strong>Use this feature when you are fixing any typos, updating any docs. For submitting any code changes you should be running tests. :-) </strong></em></p>
<p style="text-align: left;"><strong>Feel free to ask me if you face any problem in doing these things. We want more contributions!</strong></p>
<p style="text-align: left;"><strong>You can tweet me <a title="Arun Agrawal Twitter" href="http://twitter.com/arunagw" target="_blank">@arunagw</a> or catch me on my email any time.</strong></p>
<p style="text-align: left;"><strong>Cheers!</strong></p>
<p style="text-align: center;"></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/serialized-attributes-rails-3/">Serialized Attributes Rails 3</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-08-27T00:00:00+02:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content">This post will guide you how to do Serialization for your attributes in Rails.

Serialize means you want to save arbitrary Ruby data structure into the database.

Let consider we have a User model in which we want to store preferences for user in a Ruby data structure format. Previously it was only YAML.

<pre>
class User < ActiveRecord::Base
  serialize :preferences 
end
</pre>

<pre>
user = User.find 1
user.preferences = {:foo =>  'bar'}
user.save
</pre>

So now we can pass a second parameter to serialize method to use that serialization method.

<pre>
class User < ActiveRecord::Base
  serialize :preferences, SomeCoolEncoder.new
end
</pre>

You need to implement this encoder! It can be a JSON, XML, Base64. Or what every encoding technique you like to use.

A sample encoder look like this.

<pre>
class Base64Encoder
  def load(value)
    return unless value
    value.unpack('m').last
  end

  def dump(text)
    [text].pack('m')
  end
end
</pre>

This new encoder must have these methods in it!

So now you attribute is serialized and you can store data in it in your given format.

Ok so now we talk about ActiveModel::Serialization

ActiveModel::Serialization will give you serialized attribute for your classes.

A very simple example to use ActiveModel::Serialization
<pre>
class Post

  include ActiveModel::Serialization

  attr_accessor :title

  def attributes
    {'title' => title}
  end

end

# So you can use like 

post = Post.new
post.serializable_hash   # => {"title"=>nil}
post.name = "Rails is Cool!!"
post.serializable_hash   # => {"name"=>"Rails is Cool!!"}

</pre>

Can use two inbuilt Serialization techniques 

<pre>
include ActiveModel::Serializers::JSON
include ActiveModel::Serializers::Xml
</pre>

This is a very short intro for Serialization. Hope i will write more in detail soon!!

I got this from <a href="http://github.com/tenderlove" target="_blank">@tenderlove</a> talk in <a href="http://www.youtube.com/watch?v=kWOAHIpmLAI" target="_blank">RailsConf2011</a>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="3">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="1">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    
<section>
	<span>
		<img src="http://www.gravatar.com/avatar/ee85853909657f47c8a68e8a9bc7d992?s=150" alt="Gravatar of Arun Agrawal " title="Gravatar of Arun Agrawal" />
	</span>
</section>

<ol id="social-media-links">
  <li class="email"><a href="/contact">Email?</a></li>
  <li class="github"><a href="https://github.com/arunagw?rel=author">Github</a></li>
  <li class="twitter"><a href="https://twitter.com/arunagw?rel=author">Twitter</a></li>
  <li class="likes"><a href="http://likes.arun.im/">likes</a></li>
  <li class="google-plus"><a href="https://plus.google.com/103610296722452739457?rel=author">Google Plus</a></li>
  <li class="rss"><a href="http://feeds.feedburner.com/ArunAgrawal">RSS</a></li>
</ol>

<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2015/interview-on-rubyindia-podcast/">Interview on RubyIndia Podcast</a>
      </li>
    
      <li class="post">
        <a href="/2013/rails4-app-on-heroku/">Rails4 App on Heroku</a>
      </li>
    
      <li class="post">
        <a href="/2013/switched-to-heroku-and-octopress/">Switched to Heroku and Octopress</a>
      </li>
    
      <li class="post">
        <a href="/2012/slides-when-ruby-meets-java-the-power-of-torquebox/">Slides (When Ruby Meets Java - the Power of Torquebox)</a>
      </li>
    
      <li class="post">
        <a href="/2011/oauth-omniauth-twitter/">OAuth With OmniAuth and Twitter</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <p><a class="twitter-timeline" href="https://twitter.com/arunagw" data-widget-id="336944437999566849">Tweets by @arunagw</a></p>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/arunagw">@arunagw</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'arunagw',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>On Delicious</h1>
  <div id="delicious"></div>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/json/arunagw?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
  <p><a href="http://delicious.com/arunagw">My Delicious Bookmarks &raquo;</a></p>
</section>


<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/103610296722452739457?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Arun Agrawal -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
